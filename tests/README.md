# üß™ –¢–µ—Å—Ç—ã Dawly Backend

–≠—Ç–∞ –ø–∞–ø–∫–∞ —Å–æ–¥–µ—Ä–∂–∏—Ç –≤—Å–µ —Ç–µ—Å—Ç—ã –¥–ª—è backend —á–∞—Å—Ç–∏ –ø—Ä–æ–µ–∫—Ç–∞ Dawly.io.

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞

```
tests/
‚îú‚îÄ‚îÄ README.md                    # –≠—Ç–æ—Ç —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ api/                         # API —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ articles.test.ts        # –ü—Ä–∏–º–µ—Ä API —Ç–µ—Å—Ç–∞
‚îú‚îÄ‚îÄ database/                    # –¢–µ—Å—Ç—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ services/                    # –¢–µ—Å—Ç—ã —Å–µ—Ä–≤–∏—Å–æ–≤
‚îú‚îÄ‚îÄ integration/                 # –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
‚îÇ   ‚îî‚îÄ‚îÄ integration.test.ts     # –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Ç–µ—Å—Ç
‚îú‚îÄ‚îÄ unit/                        # Unit —Ç–µ—Å—Ç—ã
‚îú‚îÄ‚îÄ e2e/                        # End-to-end —Ç–µ—Å—Ç—ã
‚îî‚îÄ‚îÄ mocks/                      # –ú–æ–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–æ–≤
```

## üìÅ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

### üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- **integration.test.ts** - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã API –∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
- **jest.config.js** - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Jest (–µ—Å–ª–∏ –µ—Å—Ç—å)
- **test setup** - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Ç–µ—Å—Ç–æ–≤

## üèóÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–æ–≤

### –ü—Ä–µ—Ñ–∏–∫—Å—ã –¥–ª—è —Ñ–∞–π–ª–æ–≤:
- `*.test.js` - Jest —Ç–µ—Å—Ç—ã
- `*.spec.js` - –°–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `*.test.ts` - TypeScript —Ç–µ—Å—Ç—ã
- `*.spec.ts` - TypeScript —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏
- `integration.*` - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
- `unit.*` - Unit —Ç–µ—Å—Ç—ã
- `e2e.*` - End-to-end —Ç–µ—Å—Ç—ã

### –¢–∏–ø—ã —Ç–µ—Å—Ç–æ–≤:
- **Unit —Ç–µ—Å—Ç—ã** (`unit/`) - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π –∏ –º–µ—Ç–æ–¥–æ–≤
- **Integration —Ç–µ—Å—Ç—ã** (`integration/`) - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ API endpoints –∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ë–î
- **E2E —Ç–µ—Å—Ç—ã** (`e2e/`) - end-to-end —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ª–Ω–æ–≥–æ flow
- **API —Ç–µ—Å—Ç—ã** (`api/`) - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ REST –∏ GraphQL endpoints
- **Database —Ç–µ—Å—Ç—ã** (`database/`) - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö
- **Services —Ç–µ—Å—Ç—ã** (`services/`) - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏

## üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤

### –í—Å–µ —Ç–µ—Å—Ç—ã
```bash
npm test
```

### –¢–µ—Å—Ç—ã –≤ —Ä–µ–∂–∏–º–µ watch
```bash
npm run test:watch
```

### –¢–µ—Å—Ç—ã —Å –ø–æ–∫—Ä—ã—Ç–∏–µ–º
```bash
npm run test:coverage
```

### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Ç–µ—Å—Ç
```bash
npm test -- --testNamePattern="API"
```

### –¢–µ—Å—Ç—ã –ø–æ —Ç–∏–ø—É
```bash
# API —Ç–µ—Å—Ç—ã
npm test -- --testPathPattern="api"

# –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã
npm test -- --testPathPattern="integration"

# Database —Ç–µ—Å—Ç—ã
npm test -- --testPathPattern="database"

# Unit —Ç–µ—Å—Ç—ã
npm test -- --testPathPattern="unit"
```

## üìù –ü—Ä–∞–≤–∏–ª–∞ –Ω–∞–ø–∏—Å–∞–Ω–∏—è —Ç–µ—Å—Ç–æ–≤

### 1. –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ç–µ—Å—Ç–∞
```typescript
describe('API Endpoint', () => {
  it('should return correct response', async () => {
    // Arrange
    const request = { /* test data */ };
    
    // Act
    const response = await apiCall(request);
    
    // Assert
    expect(response.status).toBe(200);
    expect(response.data).toMatchObject(expectedData);
  });
});
```

### 2. –ò–º–µ–Ω–æ–≤–∞–Ω–∏–µ
- –§–∞–π–ª—ã: `FeatureName.test.ts`
- –û–ø–∏—Å–∞–Ω–∏—è: `should [expected behavior]`
- –ì—Ä—É–ø–ø—ã: `API`, `Database`, `Service`

### 3. –û—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏—è
- API —Ç–µ—Å—Ç—ã: `tests/api/`
- Database —Ç–µ—Å—Ç—ã: `tests/database/`
- Service —Ç–µ—Å—Ç—ã: `tests/services/`
- Integration —Ç–µ—Å—Ç—ã: `tests/integration/`

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### Jest –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –¥–ª—è Strapi
```javascript
// jest.config.js
module.exports = {
  testEnvironment: 'node',
  setupFilesAfterEnv: ['<rootDir>/jest.setup.js'],
  testPathIgnorePatterns: ['<rootDir>/node_modules/'],
  collectCoverageFrom: [
    'src/**/*.{js,ts}',
    '!src/**/*.d.ts',
  ],
};
```

### –¢–µ—Å—Ç–æ–≤–æ–µ –æ–∫—Ä—É–∂–µ–Ω–∏–µ
```typescript
// tests/setup.ts
import { Strapi } from '@strapi/strapi';

beforeAll(async () => {
  // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
});

afterAll(async () => {
  // –û—á–∏—Å—Ç–∫–∞ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
});
```

## üìä –ü–æ–∫—Ä—ã—Ç–∏–µ –∫–æ–¥–∞

–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–∫—Ä—ã—Ç–∏–µ: 80%
- Statements: 80%
- Branches: 80%
- Functions: 80%
- Lines: 80%

## üîÑ CI/CD

–¢–µ—Å—Ç—ã –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å–∫–∞—é—Ç—Å—è:
- –ü—Ä–∏ –∫–∞–∂–¥–æ–º PR
- –ü—Ä–∏ merge –≤ main
- –ü—Ä–∏ –¥–µ–ø–ª–æ–µ
- –ü–µ—Ä–µ–¥ —Ä–µ–ª–∏–∑–æ–º

## üóÑÔ∏è –¢–µ—Å—Ç–æ–≤–∞—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ù–∞—Å—Ç—Ä–æ–π–∫–∞
```bash
# –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–π –ë–î
DATABASE_NAME=dawly_test npm run test
```

### –û—á–∏—Å—Ç–∫–∞
```typescript
// –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
afterEach(async () => {
  await cleanupTestData();
});
```

## üìã –ß–µ–∫-–ª–∏—Å—Ç –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–µ—Å—Ç–æ–≤

- [ ] –¢–µ—Å—Ç –ø–æ–∫—Ä—ã–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω—É—é —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å
- [ ] –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç edge cases
- [ ] –¢–µ—Å—Ç –∏–º–µ–µ—Ç –ø–æ–Ω—è—Ç–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ
- [ ] –¢–µ—Å—Ç –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –¥—Ä—É–≥–∏—Ö —Ç–µ—Å—Ç–æ–≤
- [ ] –¢–µ—Å—Ç –æ—á–∏—â–∞–µ—Ç –ø–æ—Å–ª–µ —Å–µ–±—è —Ä–µ—Å—É—Ä—Å—ã
- [ ] –¢–µ—Å—Ç –¥–æ–±–∞–≤–ª–µ–Ω –≤ CI/CD pipeline
- [ ] –¢–µ—Å—Ç –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –º–æ–∫–∏ –¥–ª—è –≤–Ω–µ—à–Ω–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
- [ ] –¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—à–∏–±–∫–∏ –∏ –∏—Å–∫–ª—é—á–µ–Ω–∏—è
- [ ] –¢–µ—Å—Ç –ø–æ–º–µ—â–µ–Ω –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–∞–ø–∫—É (api/database/services/integration/unit/e2e)

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è API —Ç–µ—Å—Ç–æ–≤:
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –≤—Å–µ HTTP –º–µ—Ç–æ–¥—ã (GET, POST, PUT, DELETE)
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –æ–±—Ä–∞–±–æ—Ç–∫—É –æ—à–∏–±–æ–∫

### –î–ª—è Database —Ç–µ—Å—Ç–æ–≤:
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –¥–ª—è –∏–∑–æ–ª—è—Ü–∏–∏ —Ç–µ—Å—Ç–æ–≤
- –û—á–∏—â–∞–π—Ç–µ –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Ç–µ—Å—Ç–∞
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –º–∏–≥—Ä–∞—Ü–∏–∏

### –î–ª—è Integration —Ç–µ—Å—Ç–æ–≤:
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–ª–Ω—ã–µ flow
- –ü—Ä–æ–≤–µ—Ä—è–π—Ç–µ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –≤–Ω–µ—à–Ω–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –¢–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

## üîç –û—Ç–ª–∞–¥–∫–∞ —Ç–µ—Å—Ç–æ–≤

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```typescript
console.log('Test data:', testData);
console.log('Response:', response);
```

### –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
```typescript
// –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –æ—Ç–≤–µ—Ç–æ–≤ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞
fs.writeFileSync('test-response.json', JSON.stringify(response, null, 2));
```

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 21 –∏—é–ª—è 2025 